{"@t":"2025-10-23T18:17:19.6277620Z","@mt":"EzgiAI Windows Agent host built successfully"}
{"@t":"2025-10-23T18:17:19.6470020Z","@mt":"EzgiAI Windows Agent starting up...","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:19.6477980Z","@mt":"Agent ID: {AgentId}","AgentId":"d8d4c527-8dfb-4a82-b009-5406e6cb25b5","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:19.6480630Z","@mt":"Relay URL: {RelayUrl}","RelayUrl":"wss://relay-server-91742157629.europe-west3.run.app/agent","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:19.6481120Z","@mt":"Database Profiles: {ProfileCount}","ProfileCount":1,"SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:19.6487650Z","@mt":"Configuration validation passed","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:19.6492680Z","@mt":"IPC server started","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:19.6509870Z","@mt":"Checking for updates. Current version: {Version}","Version":"1.0.0.0","SourceContext":"EzgiAI.WindowsAgent.Services.UpdateService"}
{"@t":"2025-10-23T18:17:19.6535660Z","@mt":"Start processing HTTP request {HttpMethod} {Uri}","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","EventId":{"Id":100,"Name":"RequestPipelineStart"},"SourceContext":"System.Net.Http.HttpClient.Default.LogicalHandler","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:17:19.6551880Z","@mt":"Sending HTTP request {HttpMethod} {Uri}","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","EventId":{"Id":100,"Name":"RequestStart"},"SourceContext":"System.Net.Http.HttpClient.Default.ClientHandler","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:17:19.6700410Z","@mt":"Application started. Press Ctrl+C to shut down.","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:17:19.6701640Z","@mt":"Hosting environment: {EnvName}","EnvName":"Development","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:17:19.6702190Z","@mt":"Content root path: {ContentRoot}","ContentRoot":"/Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:17:20.0477450Z","@mt":"Received HTTP response headers after {ElapsedMilliseconds}ms - {StatusCode}","ElapsedMilliseconds":389.1318,"StatusCode":200,"EventId":{"Id":101,"Name":"RequestEnd"},"SourceContext":"System.Net.Http.HttpClient.Default.ClientHandler","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:17:20.0530350Z","@mt":"End processing HTTP request after {ElapsedMilliseconds}ms - {StatusCode}","ElapsedMilliseconds":400.7732,"StatusCode":200,"EventId":{"Id":101,"Name":"RequestPipelineEnd"},"SourceContext":"System.Net.Http.HttpClient.Default.LogicalHandler","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:17:20.0673900Z","@mt":"No updates available. Already on latest version: {Version}","Version":"1.0.0.0","SourceContext":"EzgiAI.WindowsAgent.Services.UpdateService"}
{"@t":"2025-10-23T18:17:20.0705180Z","@mt":"Connecting to relay server: {RelayUrl}","RelayUrl":"wss://relay-server-91742157629.europe-west3.run.app/agent","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:20.3911210Z","@mt":"Connected to relay server successfully","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:20.3949560Z","@mt":"Connection state changed: {IsConnected}","IsConnected":true,"SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:20.3953230Z","@mt":"Connected to relay server","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:20.3989860Z","@mt":"Sending message: {MessageType}","@l":"Debug","MessageType":"Register","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:20.3990800Z","@mt":"Message JSON: {Json}","@l":"Debug","Json":"{\"profiles\":[{\"connectionId\":\"d473cb15-5d8d-481c-af9f-60c8b880edf1\",\"dbType\":\"mssql\"}],\"messageType\":\"Register\"}","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:20.3993520Z","@mt":"Message sent successfully: {MessageType}","@l":"Debug","MessageType":"Register","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:20.3993890Z","@mt":"Sent registration message. Profiles: {ProfileCount}","ProfileCount":1,"SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:20.3994250Z","@mt":"Successfully connected to relay server","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:20.3994470Z","@mt":"EzgiAI Windows Agent started successfully","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:44.3714830Z","@mt":"Application is shutting down...","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:17:44.3725430Z","@mt":"EzgiAI Windows Agent shutting down...","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:44.3760640Z","@mt":"Error during shutdown","@l":"Error","@x":"System.AggregateException: One or more errors occurred. (A task was canceled.)\n ---> System.Threading.Tasks.TaskCanceledException: A task was canceled.\n   at System.Threading.Tasks.Task.GetExceptions(Boolean includeTaskCanceledExceptions)\n   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)\n   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)\n   at System.Threading.Tasks.Task.Wait(TimeSpan timeout, CancellationToken cancellationToken)\n   at System.Threading.Tasks.Task.Wait(TimeSpan timeout)\n   at WindowsAgent.Shared.IpcServer.Dispose() in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent.Shared/IpcServer.cs:line 119\n   at EzgiAI.WindowsAgent.WindowsAgentService.StopAsync(CancellationToken cancellationToken) in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent/Worker.cs:line 97\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)\n   at EzgiAI.WindowsAgent.WindowsAgentService.StopAsync(CancellationToken cancellationToken)\n   at Microsoft.Extensions.Hosting.Internal.Host.<>c.<StopAsync>b__16_1(IHostedService service, CancellationToken token)\n   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)\n   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)\n   at Microsoft.Extensions.Hosting.Internal.Host.StopAsync(CancellationToken cancellationToken)\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)\n   at Microsoft.Extensions.Hosting.Internal.Host.StopAsync(CancellationToken cancellationToken)\n   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.WaitForShutdownAsync(IHost host, CancellationToken token)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1.ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1.MoveNext(Thread threadPoolThread)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1.ExecuteFromThreadPool(Thread threadPoolThread)\n   at System.Threading.ThreadPoolWorkQueue.Dispatch()\n   at System.Threading.PortableThreadPool.WorkerThread.WorkerThreadStart()\n   at System.Threading.Thread.StartCallback()\n--- End of stack trace from previous location ---\n\n   --- End of inner exception stack trace ---\n   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)\n   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)\n   at System.Threading.Tasks.Task.Wait(TimeSpan timeout, CancellationToken cancellationToken)\n   at System.Threading.Tasks.Task.Wait(TimeSpan timeout)\n   at WindowsAgent.Shared.IpcServer.Dispose() in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent.Shared/IpcServer.cs:line 119\n   at EzgiAI.WindowsAgent.WindowsAgentService.StopAsync(CancellationToken cancellationToken) in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent/Worker.cs:line 97","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:44.3766660Z","@mt":"Fatal error in Windows Agent service","@l":"Fatal","@x":"System.Threading.Tasks.TaskCanceledException: A task was canceled.\n   at EzgiAI.WindowsAgent.WindowsAgentService.ExecuteAsync(CancellationToken stoppingToken) in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent/Worker.cs:line 78","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:44.3774350Z","@mt":"EzgiAI Windows Agent stopped","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:44.3808510Z","@mt":"EzgiAI Windows Agent stopped cleanly"}
{"@t":"2025-10-23T18:17:51.5480580Z","@mt":"EzgiAI Windows Agent host built successfully"}
{"@t":"2025-10-23T18:17:51.5695390Z","@mt":"EzgiAI Windows Agent starting up...","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:51.5702800Z","@mt":"Agent ID: {AgentId}","AgentId":"d8d4c527-8dfb-4a82-b009-5406e6cb25b5","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:51.5705090Z","@mt":"Relay URL: {RelayUrl}","RelayUrl":"wss://relay-server-91742157629.europe-west3.run.app/agent","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:51.5705530Z","@mt":"Database Profiles: {ProfileCount}","ProfileCount":1,"SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:51.5711230Z","@mt":"Configuration validation passed","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:51.5716550Z","@mt":"IPC server started","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:51.5731230Z","@mt":"Checking for updates. Current version: {Version}","Version":"1.0.0.0","SourceContext":"EzgiAI.WindowsAgent.Services.UpdateService"}
{"@t":"2025-10-23T18:17:51.5756660Z","@mt":"Start processing HTTP request {HttpMethod} {Uri}","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","EventId":{"Id":100,"Name":"RequestPipelineStart"},"SourceContext":"System.Net.Http.HttpClient.Default.LogicalHandler","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:17:51.5772360Z","@mt":"Sending HTTP request {HttpMethod} {Uri}","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","EventId":{"Id":100,"Name":"RequestStart"},"SourceContext":"System.Net.Http.HttpClient.Default.ClientHandler","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:17:51.5859070Z","@mt":"Application started. Press Ctrl+C to shut down.","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:17:51.5860120Z","@mt":"Hosting environment: {EnvName}","EnvName":"Development","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:17:51.5860370Z","@mt":"Content root path: {ContentRoot}","ContentRoot":"/Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:17:51.9415460Z","@mt":"Received HTTP response headers after {ElapsedMilliseconds}ms - {StatusCode}","ElapsedMilliseconds":363.499,"StatusCode":200,"EventId":{"Id":101,"Name":"RequestEnd"},"SourceContext":"System.Net.Http.HttpClient.Default.ClientHandler","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:17:51.9454800Z","@mt":"End processing HTTP request after {ElapsedMilliseconds}ms - {StatusCode}","ElapsedMilliseconds":371.154,"StatusCode":200,"EventId":{"Id":101,"Name":"RequestPipelineEnd"},"SourceContext":"System.Net.Http.HttpClient.Default.LogicalHandler","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:17:51.9561770Z","@mt":"No updates available. Already on latest version: {Version}","Version":"1.0.0.0","SourceContext":"EzgiAI.WindowsAgent.Services.UpdateService"}
{"@t":"2025-10-23T18:17:51.9573890Z","@mt":"Connecting to relay server: {RelayUrl}","RelayUrl":"wss://relay-server-91742157629.europe-west3.run.app/agent","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:52.1561770Z","@mt":"Connected to relay server successfully","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:52.1586600Z","@mt":"Connection state changed: {IsConnected}","IsConnected":true,"SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:52.1588880Z","@mt":"Connected to relay server","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:52.1612890Z","@mt":"Sending message: {MessageType}","@l":"Debug","MessageType":"Register","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:52.1613540Z","@mt":"Message JSON: {Json}","@l":"Debug","Json":"{\"profiles\":[{\"connectionId\":\"d473cb15-5d8d-481c-af9f-60c8b880edf1\",\"dbType\":\"mssql\"}],\"messageType\":\"Register\"}","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:52.1615690Z","@mt":"Message sent successfully: {MessageType}","@l":"Debug","MessageType":"Register","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:17:52.1615860Z","@mt":"Sent registration message. Profiles: {ProfileCount}","ProfileCount":1,"SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:52.1616090Z","@mt":"Successfully connected to relay server","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:17:52.1616180Z","@mt":"EzgiAI Windows Agent started successfully","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:29.3068370Z","@mt":"Application is shutting down...","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:18:29.3080970Z","@mt":"EzgiAI Windows Agent shutting down...","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:29.3121210Z","@mt":"Error during shutdown","@l":"Error","@x":"System.AggregateException: One or more errors occurred. (A task was canceled.)\n ---> System.Threading.Tasks.TaskCanceledException: A task was canceled.\n   at System.Threading.Tasks.Task.GetExceptions(Boolean includeTaskCanceledExceptions)\n   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)\n   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)\n   at System.Threading.Tasks.Task.Wait(TimeSpan timeout, CancellationToken cancellationToken)\n   at System.Threading.Tasks.Task.Wait(TimeSpan timeout)\n   at WindowsAgent.Shared.IpcServer.Dispose() in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent.Shared/IpcServer.cs:line 119\n   at EzgiAI.WindowsAgent.WindowsAgentService.StopAsync(CancellationToken cancellationToken) in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent/Worker.cs:line 97\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)\n   at EzgiAI.WindowsAgent.WindowsAgentService.StopAsync(CancellationToken cancellationToken)\n   at Microsoft.Extensions.Hosting.Internal.Host.<>c.<StopAsync>b__16_1(IHostedService service, CancellationToken token)\n   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)\n   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)\n   at Microsoft.Extensions.Hosting.Internal.Host.StopAsync(CancellationToken cancellationToken)\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)\n   at Microsoft.Extensions.Hosting.Internal.Host.StopAsync(CancellationToken cancellationToken)\n   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.WaitForShutdownAsync(IHost host, CancellationToken token)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1.ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1.MoveNext(Thread threadPoolThread)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1.ExecuteFromThreadPool(Thread threadPoolThread)\n   at System.Threading.ThreadPoolWorkQueue.Dispatch()\n   at System.Threading.PortableThreadPool.WorkerThread.WorkerThreadStart()\n   at System.Threading.Thread.StartCallback()\n--- End of stack trace from previous location ---\n\n   --- End of inner exception stack trace ---\n   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)\n   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)\n   at System.Threading.Tasks.Task.Wait(TimeSpan timeout, CancellationToken cancellationToken)\n   at System.Threading.Tasks.Task.Wait(TimeSpan timeout)\n   at WindowsAgent.Shared.IpcServer.Dispose() in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent.Shared/IpcServer.cs:line 119\n   at EzgiAI.WindowsAgent.WindowsAgentService.StopAsync(CancellationToken cancellationToken) in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent/Worker.cs:line 97","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:29.3126110Z","@mt":"Fatal error in Windows Agent service","@l":"Fatal","@x":"System.Threading.Tasks.TaskCanceledException: A task was canceled.\n   at EzgiAI.WindowsAgent.WindowsAgentService.ExecuteAsync(CancellationToken stoppingToken) in /Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent/Worker.cs:line 78","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:29.3130550Z","@mt":"EzgiAI Windows Agent stopped","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:29.3174880Z","@mt":"EzgiAI Windows Agent stopped cleanly"}
{"@t":"2025-10-23T18:18:29.3176830Z","@mt":"Receive loop cancelled","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:18:37.0954920Z","@mt":"EzgiAI Windows Agent host built successfully"}
{"@t":"2025-10-23T18:18:37.1158130Z","@mt":"EzgiAI Windows Agent starting up...","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:37.1165010Z","@mt":"Agent ID: {AgentId}","AgentId":"d8d4c527-8dfb-4a82-b009-5406e6cb25b5","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:37.1167210Z","@mt":"Relay URL: {RelayUrl}","RelayUrl":"wss://relay-server-91742157629.europe-west3.run.app/agent","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:37.1167670Z","@mt":"Database Profiles: {ProfileCount}","ProfileCount":1,"SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:37.1173240Z","@mt":"Configuration validation passed","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:37.1177430Z","@mt":"IPC server started","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:37.1191890Z","@mt":"Checking for updates. Current version: {Version}","Version":"1.0.0.0","SourceContext":"EzgiAI.WindowsAgent.Services.UpdateService"}
{"@t":"2025-10-23T18:18:37.1217020Z","@mt":"Start processing HTTP request {HttpMethod} {Uri}","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","EventId":{"Id":100,"Name":"RequestPipelineStart"},"SourceContext":"System.Net.Http.HttpClient.Default.LogicalHandler","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:18:37.1231650Z","@mt":"Sending HTTP request {HttpMethod} {Uri}","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","EventId":{"Id":100,"Name":"RequestStart"},"SourceContext":"System.Net.Http.HttpClient.Default.ClientHandler","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:18:37.1313140Z","@mt":"Application started. Press Ctrl+C to shut down.","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:18:37.1313880Z","@mt":"Hosting environment: {EnvName}","EnvName":"Development","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:18:37.1314110Z","@mt":"Content root path: {ContentRoot}","ContentRoot":"/Users/raifemreakbay/Desktop/ezgiai/ezgiai-windows-agent/src/WindowsAgent","SourceContext":"Microsoft.Hosting.Lifetime"}
{"@t":"2025-10-23T18:18:37.5087090Z","@mt":"Received HTTP response headers after {ElapsedMilliseconds}ms - {StatusCode}","ElapsedMilliseconds":384.7332,"StatusCode":200,"EventId":{"Id":101,"Name":"RequestEnd"},"SourceContext":"System.Net.Http.HttpClient.Default.ClientHandler","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:18:37.5134190Z","@mt":"End processing HTTP request after {ElapsedMilliseconds}ms - {StatusCode}","ElapsedMilliseconds":392.9715,"StatusCode":200,"EventId":{"Id":101,"Name":"RequestPipelineEnd"},"SourceContext":"System.Net.Http.HttpClient.Default.LogicalHandler","HttpMethod":"GET","Uri":"https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest","Scope":["HTTP GET https://api.github.com/repos/raifemre/ezgiai-windows-agent-public/releases/latest"]}
{"@t":"2025-10-23T18:18:37.5242170Z","@mt":"No updates available. Already on latest version: {Version}","Version":"1.0.0.0","SourceContext":"EzgiAI.WindowsAgent.Services.UpdateService"}
{"@t":"2025-10-23T18:18:37.5252780Z","@mt":"Connecting to relay server: {RelayUrl}","RelayUrl":"wss://relay-server-91742157629.europe-west3.run.app/agent","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:18:37.7283140Z","@mt":"Connected to relay server successfully","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:18:37.7311860Z","@mt":"Connection state changed: {IsConnected}","IsConnected":true,"SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:18:37.7314620Z","@mt":"Connected to relay server","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:37.7337570Z","@mt":"Sending message: {MessageType}","@l":"Debug","MessageType":"Register","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:18:37.7338080Z","@mt":"Message JSON: {Json}","@l":"Debug","Json":"{\"profiles\":[{\"connectionId\":\"d473cb15-5d8d-481c-af9f-60c8b880edf1\",\"dbType\":\"mssql\"}],\"messageType\":\"Register\"}","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:18:37.7340160Z","@mt":"Message sent successfully: {MessageType}","@l":"Debug","MessageType":"Register","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:18:37.7340470Z","@mt":"Sent registration message. Profiles: {ProfileCount}","ProfileCount":1,"SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:37.7340770Z","@mt":"Successfully connected to relay server","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:18:37.7340910Z","@mt":"EzgiAI Windows Agent started successfully","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:23:39.9601820Z","@mt":"Relay server closed connection: {StatusCode} - {StatusDescription}","StatusCode":"NormalClosure","StatusDescription":"","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:23:39.9614880Z","@mt":"Connection state changed: {IsConnected}","IsConnected":false,"SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:23:39.9615760Z","@mt":"Disconnected from relay server","@l":"Warning","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:23:42.7929520Z","@mt":"Connection lost. Attempting to reconnect...","@l":"Warning","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:23:42.7959810Z","@mt":"Reconnect attempt {Attempt}. Waiting {Delay} seconds...","Attempt":1,"Delay":1,"SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:23:43.7976400Z","@mt":"Connecting to relay server: {RelayUrl}","RelayUrl":"wss://relay-server-91742157629.europe-west3.run.app/agent","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:23:44.1326830Z","@mt":"Connected to relay server successfully","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:23:44.1328590Z","@mt":"Connection state changed: {IsConnected}","IsConnected":true,"SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:23:44.1328990Z","@mt":"Connected to relay server","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:23:44.1332740Z","@mt":"Sending message: {MessageType}","@l":"Debug","MessageType":"Register","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:23:44.1333050Z","@mt":"Message JSON: {Json}","@l":"Debug","Json":"{\"profiles\":[{\"connectionId\":\"d473cb15-5d8d-481c-af9f-60c8b880edf1\",\"dbType\":\"mssql\"}],\"messageType\":\"Register\"}","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:23:44.1334490Z","@mt":"Message sent successfully: {MessageType}","@l":"Debug","MessageType":"Register","SourceContext":"EzgiAI.WindowsAgent.Services.RelayClient"}
{"@t":"2025-10-23T18:23:44.1334710Z","@mt":"Sent registration message. Profiles: {ProfileCount}","ProfileCount":1,"SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
{"@t":"2025-10-23T18:23:44.1335080Z","@mt":"Reconnected successfully","SourceContext":"EzgiAI.WindowsAgent.WindowsAgentService"}
